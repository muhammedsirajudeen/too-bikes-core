[{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\admin\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useRouter' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useTheme' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useTheme } from \"next-themes\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Sidebar,\r\n    SidebarContent,\r\n    SidebarFooter,\r\n    SidebarGroup,\r\n    SidebarGroupContent,\r\n    SidebarHeader,\r\n    SidebarMenu,\r\n    SidebarMenuButton,\r\n    SidebarMenuItem,\r\n    SidebarProvider,\r\n    SidebarTrigger,\r\n} from \"@/components/ui/sidebar\";\r\nimport { Home, Users, Settings, LogOut, Package, User, Moon, Sun, Store, Car } from \"lucide-react\";\r\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\r\n\r\nexport default function AdminDashboard() {\r\n    // ... existing code ...\r\n    const navigationItems = [\r\n        { name: 'Dashboard', icon: Home, href: '/admin/dashboard' },\r\n        { name: 'Users', icon: Users, href: '/admin/users' },\r\n        { name: 'Orders', icon: Package, href: '/admin/orders' },\r\n        { name: 'Store Management', icon: Store, href: '/admin/stores' },\r\n        { name: 'Vehicle Management', icon: Car, href: '/admin/vehicles' },\r\n        { name: 'Settings', icon: Settings, href: '/admin/settings' },\r\n    ];\r\n\r\n    // Get initials for avatar\r\n    const initials = adminUsername\r\n        .split(' ')\r\n        .map(n => n[0])\r\n        .join('')\r\n        .toUpperCase()\r\n        .slice(0, 2) || 'AU';\r\n\r\n    return (\r\n        <SidebarProvider open={sidebarOpen} onOpenChange={setSidebarOpen}>\r\n            <div className=\"flex min-h-screen w-full\">\r\n                <Sidebar collapsible=\"icon\">\r\n                    <SidebarHeader className=\"border-b border-gray-200 dark:border-gray-700 p-4\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                            <User className=\"w-5 h-5\" />\r\n                            <span className=\"font-bold group-data-[collapsible=icon]:hidden\">Admin Panel</span>\r\n                        </div>\r\n                    </SidebarHeader>\r\n\r\n                    <SidebarContent>\r\n                        <SidebarGroup>\r\n                            <SidebarGroupContent>\r\n                                <SidebarMenu>\r\n                                    {navigationItems.map((item) => {\r\n                                        const Icon = item.icon;\r\n                                        return (\r\n                                            <SidebarMenuItem key={item.name}>\r\n                                                <SidebarMenuButton\r\n                                                    onClick={() => router.push(item.href)}\r\n                                                    tooltip={item.name}\r\n                                                >\r\n                                                    <Icon />\r\n                                                    <span>{item.name}</span>\r\n                                                </SidebarMenuButton>\r\n                                            </SidebarMenuItem>\r\n                                        );\r\n                                    })}\r\n                                </SidebarMenu>\r\n                            </SidebarGroupContent>\r\n                        </SidebarGroup>\r\n                    </SidebarContent>\r\n\r\n                    <SidebarFooter className=\"border-t border-gray-200 dark:border-gray-700 p-2\">\r\n                        <SidebarMenu>\r\n                            <SidebarMenuItem>\r\n                                <SidebarMenuButton\r\n                                    size=\"lg\"\r\n                                    className=\"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground\"\r\n                                >\r\n                                    <Avatar className=\"h-8 w-8 rounded-lg\">\r\n                                        <AvatarFallback className=\"rounded-lg bg-blue-600 text-white\">\r\n                                            {initials}\r\n                                        </AvatarFallback>\r\n                                    </Avatar>\r\n                                    <div className=\"grid flex-1 text-left text-sm leading-tight\">\r\n                                        <span className=\"truncate font-semibold\">{adminUsername}</span>\r\n                                        <span className=\"truncate text-xs text-gray-500 dark:text-gray-400\">Admin User</span>\r\n                                    </div>\r\n                                </SidebarMenuButton>\r\n                            </SidebarMenuItem>\r\n                            <SidebarMenuItem>\r\n                                <SidebarMenuButton onClick={handleLogout} tooltip=\"Logout\">\r\n                                    <LogOut />\r\n                                    <span>Logout</span>\r\n                                </SidebarMenuButton>\r\n                            </SidebarMenuItem>\r\n                        </SidebarMenu>\r\n                    </SidebarFooter>\r\n                </Sidebar>\r\n\r\n                <main className=\"flex-1 overflow-auto bg-gray-50 dark:bg-[#0f0f23]\">\r\n                    {/* Header with sidebar trigger */}\r\n                    <div className=\"sticky top-0 z-10 bg-white dark:bg-[#1a1a2e] border-b border-gray-200 dark:border-gray-700 px-4 py-3 flex items-center gap-3\">\r\n                        <SidebarTrigger />\r\n                        <div className=\"flex items-center justify-between flex-1\">\r\n                            <div>\r\n                                <p className=\"text-sm text-gray-500 dark:text-gray-400\">Workspace</p>\r\n                                <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white\">Home</h2>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"text-sm text-gray-500 dark:text-gray-400 hidden md:block\">\r\n                                    Press <kbd className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-800 rounded border border-gray-300 dark:border-gray-600\">Ctrl+B</kbd> to toggle\r\n                                </div>\r\n                                <Button\r\n                                    variant=\"ghost\"\r\n                                    size=\"icon\"\r\n                                    onClick={() => setTheme(theme === \"dark\" ? \"light\" : \"dark\")}\r\n                                    className=\"h-9 w-9\"\r\n                                >\r\n                                    <Sun className=\"h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\r\n                                    <Moon className=\"absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\r\n                                    <span className=\"sr-only\">Toggle theme</span>\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Main Content */}\r\n                    <div className=\"p-8\">\r\n                        <div className=\"max-w-6xl mx-auto\">\r\n                            <h2 className=\"text-3xl font-bold mb-2 text-gray-900 dark:text-white\">Dashboard</h2>\r\n                            <p className=\"text-gray-600 dark:text-gray-400 mb-8\">\r\n                                Overview of your TooBikes platform metrics and analytics.\r\n                            </p>\r\n\r\n                            {/* Dashboard Cards */}\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8\">\r\n                                <div className=\"bg-white dark:bg-[#1e1e3f] rounded-xl p-6 border border-gray-200 dark:border-gray-800\">\r\n                                    <div className=\"flex items-center justify-between mb-4\">\r\n                                        <p className=\"text-sm text-gray-600 dark:text-gray-400\">Total Users</p>\r\n                                        <Users className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\r\n                                    </div>\r\n                                    <p className=\"text-3xl font-bold mb-1 text-gray-900 dark:text-white\">1,234</p>\r\n                                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">↑ 12% from last month</p>\r\n                                </div>\r\n\r\n                                <div className=\"bg-white dark:bg-[#1e1e3f] rounded-xl p-6 border border-gray-200 dark:border-gray-800\">\r\n                                    <div className=\"flex items-center justify-between mb-4\">\r\n                                        <p className=\"text-sm text-gray-600 dark:text-gray-400\">Total Orders</p>\r\n                                        <Package className=\"w-5 h-5 text-green-600 dark:text-green-400\" />\r\n                                    </div>\r\n                                    <p className=\"text-3xl font-bold mb-1 text-gray-900 dark:text-white\">567</p>\r\n                                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">↑ 8% from last month</p>\r\n                                </div>\r\n\r\n                                <div className=\"bg-white dark:bg-[#1e1e3f] rounded-xl p-6 border border-gray-200 dark:border-gray-800\">\r\n                                    <div className=\"flex items-center justify-between mb-4\">\r\n                                        <p className=\"text-sm text-gray-600 dark:text-gray-400\">Active Bikes</p>\r\n                                        <Settings className=\"w-5 h-5 text-purple-600 dark:text-purple-400\" />\r\n                                    </div>\r\n                                    <p className=\"text-3xl font-bold mb-1 text-gray-900 dark:text-white\">89</p>\r\n                                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">↑ 5% from last month</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Additional sections matching the reference image */}\r\n                            <div className=\"space-y-6\">\r\n                                <div className=\"bg-white dark:bg-[#1e1e3f] rounded-xl p-6 border border-gray-200 dark:border-gray-800\">\r\n                                    <h3 className=\"text-lg font-semibold mb-4 text-gray-900 dark:text-white\">Revenue Breakdown</h3>\r\n                                    <div className=\"space-y-3\">\r\n                                        <div className=\"flex items-center justify-between py-2\">\r\n                                            <span className=\"text-gray-600 dark:text-gray-400\">Platform Revenue</span>\r\n                                            <span className=\"font-semibold text-gray-900 dark:text-white\">₹45,000</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center justify-between py-2\">\r\n                                            <span className=\"text-gray-600 dark:text-gray-400\">Vendor Payouts</span>\r\n                                            <span className=\"font-semibold text-gray-900 dark:text-white\">₹32,000</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center justify-between py-2\">\r\n                                            <span className=\"text-gray-600 dark:text-gray-400\">Delivery Payouts</span>\r\n                                            <span className=\"font-semibold text-gray-900 dark:text-white\">₹8,500</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"bg-white dark:bg-[#1e1e3f] rounded-xl p-6 border border-gray-200 dark:border-gray-800\">\r\n                                    <h3 className=\"text-lg font-semibold mb-4 text-gray-900 dark:text-white\">Customer Overview</h3>\r\n                                    <div className=\"space-y-3\">\r\n                                        <div className=\"flex items-center justify-between py-2\">\r\n                                            <span className=\"text-gray-600 dark:text-gray-400\">Total Customers</span>\r\n                                            <span className=\"font-semibold text-gray-900 dark:text-white\">1,234</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center justify-between py-2\">\r\n                                            <span className=\"text-gray-600 dark:text-gray-400\">Active Customers</span>\r\n                                            <span className=\"font-semibold text-gray-900 dark:text-white\">892</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center justify-between py-2\">\r\n                                            <span className=\"text-gray-600 dark:text-gray-400\">Inactive Customers</span>\r\n                                            <span className=\"font-semibold text-gray-900 dark:text-white\">342</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center justify-between py-2\">\r\n                                            <span className=\"text-gray-600 dark:text-gray-400\">Repeat Customers</span>\r\n                                            <span className=\"font-semibold text-gray-900 dark:text-white\">456</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </main>\r\n            </div>\r\n        </SidebarProvider>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\admin\\stores\\page.tsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Declaration or statement expected.","line":271,"column":0}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useTheme } from \"next-themes\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Sidebar,\r\n    SidebarContent,\r\n    SidebarFooter,\r\n    SidebarGroup,\r\n    SidebarGroupContent,\r\n    SidebarHeader,\r\n    SidebarMenu,\r\n    SidebarMenuButton,\r\n    SidebarMenuItem,\r\n    SidebarProvider,\r\n    SidebarTrigger,\r\n} from \"@/components/ui/sidebar\";\r\nimport { Home, Users, Settings, LogOut, Package, User, Moon, Sun, Store, Plus, Pencil, Trash2, Car } from \"lucide-react\";\r\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\r\n// ... existing code ...\r\nconst navigationItems = [\r\n    { name: 'Dashboard', icon: Home, href: '/admin/dashboard' },\r\n    { name: 'Users', icon: Users, href: '/admin/users' },\r\n    { name: 'Orders', icon: Package, href: '/admin/orders' },\r\n    { name: 'Store Management', icon: Store, href: '/admin/stores' },\r\n    { name: 'Vehicle Management', icon: Car, href: '/admin/vehicles' },\r\n    { name: 'Settings', icon: Settings, href: '/admin/settings' },\r\n];\r\n\r\nconst initials = adminUsername\r\n    .split(' ')\r\n    .map(n => n[0])\r\n    .join('')\r\n    .toUpperCase()\r\n    .slice(0, 2) || 'AU';\r\n\r\nreturn (\r\n    <SidebarProvider open={sidebarOpen} onOpenChange={setSidebarOpen}>\r\n        <div className=\"flex min-h-screen w-full\">\r\n            <Sidebar collapsible=\"icon\">\r\n                <SidebarHeader className=\"border-b border-gray-200 dark:border-gray-700 p-4\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <User className=\"w-5 h-5\" />\r\n                        <span className=\"font-bold group-data-[collapsible=icon]:hidden\">Admin Panel</span>\r\n                    </div>\r\n                </SidebarHeader>\r\n\r\n                <SidebarContent>\r\n                    <SidebarGroup>\r\n                        <SidebarGroupContent>\r\n                            <SidebarMenu>\r\n                                {navigationItems.map((item) => {\r\n                                    const Icon = item.icon;\r\n                                    const isActive = item.href === '/admin/stores';\r\n                                    return (\r\n                                        <SidebarMenuItem key={item.name}>\r\n                                            <SidebarMenuButton\r\n                                                onClick={() => router.push(item.href)}\r\n                                                tooltip={item.name}\r\n                                                isActive={isActive}\r\n                                            >\r\n                                                <Icon />\r\n                                                <span>{item.name}</span>\r\n                                            </SidebarMenuButton>\r\n                                        </SidebarMenuItem>\r\n                                    );\r\n                                })}\r\n                            </SidebarMenu>\r\n                        </SidebarGroupContent>\r\n                    </SidebarGroup>\r\n                </SidebarContent>\r\n\r\n                <SidebarFooter className=\"border-t border-gray-200 dark:border-gray-700 p-2\">\r\n                    <SidebarMenu>\r\n                        <SidebarMenuItem>\r\n                            <SidebarMenuButton\r\n                                size=\"lg\"\r\n                                className=\"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground\"\r\n                            >\r\n                                <Avatar className=\"h-8 w-8 rounded-lg\">\r\n                                    <AvatarFallback className=\"rounded-lg bg-blue-600 text-white\">\r\n                                        {initials}\r\n                                    </AvatarFallback>\r\n                                </Avatar>\r\n                                <div className=\"grid flex-1 text-left text-sm leading-tight\">\r\n                                    <span className=\"truncate font-semibold\">{adminUsername}</span>\r\n                                    <span className=\"truncate text-xs text-gray-500 dark:text-gray-400\">Admin User</span>\r\n                                </div>\r\n                            </SidebarMenuButton>\r\n                        </SidebarMenuItem>\r\n                        <SidebarMenuItem>\r\n                            <SidebarMenuButton onClick={handleLogout} tooltip=\"Logout\">\r\n                                <LogOut />\r\n                                <span>Logout</span>\r\n                            </SidebarMenuButton>\r\n                        </SidebarMenuItem>\r\n                    </SidebarMenu>\r\n                </SidebarFooter>\r\n            </Sidebar>\r\n\r\n            <main className=\"flex-1 overflow-auto bg-gray-50 dark:bg-[#0f0f23]\">\r\n                <div className=\"sticky top-0 z-10 bg-white dark:bg-[#1a1a2e] border-b border-gray-200 dark:border-gray-700 px-4 py-3 flex items-center gap-3\">\r\n                    <SidebarTrigger />\r\n                    <div className=\"flex items-center justify-between flex-1\">\r\n                        <div>\r\n                            <p className=\"text-sm text-gray-500 dark:text-gray-400\">Workspace</p>\r\n                            <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white\">Store Management</h2>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <Button\r\n                                onClick={handleAddStore}\r\n                                className=\"flex items-center gap-2\"\r\n                            >\r\n                                <Plus className=\"w-4 h-4\" />\r\n                                Add Store\r\n                            </Button>\r\n                            <Button\r\n                                variant=\"ghost\"\r\n                                size=\"icon\"\r\n                                onClick={() => setTheme(theme === \"dark\" ? \"light\" : \"dark\")}\r\n                                className=\"h-9 w-9\"\r\n                            >\r\n                                <Sun className=\"h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\r\n                                <Moon className=\"absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\r\n                                <span className=\"sr-only\">Toggle theme</span>\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"p-8\">\r\n                    <div className=\"max-w-7xl mx-auto\">\r\n                        <h2 className=\"text-3xl font-bold mb-2 text-gray-900 dark:text-white\">Stores</h2>\r\n                        <p className=\"text-gray-600 dark:text-gray-400 mb-8\">\r\n                            Manage all store locations and their details.\r\n                        </p>\r\n\r\n                        {loading ? (\r\n                            <div className=\"text-center py-12\">\r\n                                <p className=\"text-gray-500 dark:text-gray-400\">Loading stores...</p>\r\n                            </div>\r\n                        ) : stores.length === 0 ? (\r\n                            <div className=\"bg-white dark:bg-[#1e1e3f] rounded-xl p-12 border border-gray-200 dark:border-gray-800 text-center\">\r\n                                <Store className=\"w-16 h-16 mx-auto mb-4 text-gray-400\" />\r\n                                <h3 className=\"text-xl font-semibold mb-2 text-gray-900 dark:text-white\">No stores yet</h3>\r\n                                <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n                                    Get started by adding your first store location.\r\n                                </p>\r\n                                <Button onClick={handleAddStore}>\r\n                                    <Plus className=\"w-4 h-4 mr-2\" />\r\n                                    Add Your First Store\r\n                                </Button>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"bg-white dark:bg-[#1e1e3f] rounded-xl border border-gray-200 dark:border-gray-800 overflow-hidden\">\r\n                                <div className=\"overflow-x-auto\">\r\n                                    <table className=\"w-full\">\r\n                                        <thead className=\"bg-gray-50 dark:bg-[#0f0f23] border-b border-gray-200 dark:border-gray-800\">\r\n                                            <tr>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                    Name\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                    Address\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                    District\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                    Hours\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                    Contact\r\n                                                </th>\r\n                                                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                    Actions\r\n                                                </th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody className=\"divide-y divide-gray-200 dark:divide-gray-800\">\r\n                                            {stores.map((store) => (\r\n                                                <tr key={store._id} className=\"hover:bg-gray-50 dark:hover:bg-[#0f0f23]\">\r\n                                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                        <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                                                            {store.name}\r\n                                                        </div>\r\n                                                        {store.description && (\r\n                                                            <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                                                {store.description}\r\n                                                            </div>\r\n                                                        )}\r\n                                                    </td>\r\n                                                    <td className=\"px-6 py-4\">\r\n                                                        <div className=\"text-sm text-gray-900 dark:text-white\">\r\n                                                            {store.address}\r\n                                                        </div>\r\n                                                    </td>\r\n                                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                        <div className=\"text-sm text-gray-900 dark:text-white\">\r\n                                                            {store.district}\r\n                                                        </div>\r\n                                                    </td>\r\n                                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                        <div className=\"text-sm text-gray-900 dark:text-white\">\r\n                                                            {store.openingTime} - {store.closingTime}\r\n                                                        </div>\r\n                                                    </td>\r\n                                                    <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                        <div className=\"text-sm text-gray-900 dark:text-white\">\r\n                                                            {store.contactNumber || '-'}\r\n                                                        </div>\r\n                                                    </td>\r\n                                                    <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\r\n                                                        <div className=\"flex items-center justify-end gap-2\">\r\n                                                            <Button\r\n                                                                variant=\"ghost\"\r\n                                                                size=\"icon\"\r\n                                                                onClick={() => handleEditStore(store)}\r\n                                                                className=\"h-8 w-8\"\r\n                                                            >\r\n                                                                <Pencil className=\"h-4 w-4\" />\r\n                                                            </Button>\r\n                                                            <Button\r\n                                                                variant=\"ghost\"\r\n                                                                size=\"icon\"\r\n                                                                onClick={() => handleDeleteClick(store._id)}\r\n                                                                className=\"h-8 w-8 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20\"\r\n                                                            >\r\n                                                                <Trash2 className=\"h-4 w-4\" />\r\n                                                            </Button>\r\n                                                        </div>\r\n                                                    </td>\r\n                                                </tr>\r\n                                            ))}\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </main>\r\n        </div>\r\n\r\n        <StoreDialog\r\n            open={dialogOpen}\r\n            onOpenChange={setDialogOpen}\r\n            mode={dialogMode}\r\n            store={selectedStore}\r\n            onSuccess={handleDialogSuccess}\r\n        />\r\n\r\n        <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\r\n            <AlertDialogContent>\r\n                <AlertDialogHeader>\r\n                    <AlertDialogTitle>Are you sure?</AlertDialogTitle>\r\n                    <AlertDialogDescription>\r\n                        This action cannot be undone. This will permanently delete the store from the database.\r\n                    </AlertDialogDescription>\r\n                </AlertDialogHeader>\r\n                <AlertDialogFooter>\r\n                    <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n                    <AlertDialogAction onClick={confirmDelete} className=\"bg-red-600 hover:bg-red-700\">Delete</AlertDialogAction>\r\n                </AlertDialogFooter>\r\n            </AlertDialogContent>\r\n        </AlertDialog>\r\n    </SidebarProvider>\r\n);\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\api\\v1\\admin\\logout\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_request' is defined but never used.","line":8,"column":28,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from \"next/server\";\r\nimport { HttpStatus } from \"@/constants/status.constant\";\r\n\r\n/**\r\n * Admin Logout Endpoint\r\n * Clears the admin refresh token cookie\r\n */\r\nexport async function POST(_request: NextRequest) {\r\n    const response = NextResponse.json({\r\n        success: true,\r\n        message: \"Logged out successfully\"\r\n    }, { status: HttpStatus.OK });\r\n\r\n    // Clear the refresh token cookie\r\n    response.cookies.set('admin_refresh_token', '', {\r\n        httpOnly: true,\r\n        secure: process.env.NODE_ENV === 'production',\r\n        sameSite: 'strict',\r\n        maxAge: 0, // Expire immediately\r\n        path: '/',\r\n    });\r\n\r\n    return response;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\api\\v1\\admin\\stores\\[id]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":53,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { HttpStatus } from \"@/constants/status.constant\";\r\nimport { StoreRepository } from \"@/repository/store.repository\";\r\nimport { withLoggingAndErrorHandling } from \"@/utils/decorator.utilt\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { z } from \"zod\";\r\nimport { Types } from \"mongoose\";\r\n\r\nconst storeRepo = new StoreRepository();\r\n\r\n// Schema for updating a store\r\nconst updateStoreSchema = z.object({\r\n    name: z.string().min(1, \"Store name is required\").trim().optional(),\r\n    description: z.string().optional(),\r\n    address: z.string().min(1, \"Address is required\").optional(),\r\n    district: z.string().min(1, \"District is required\").optional(),\r\n    latitude: z.number().min(-90).max(90).optional(),\r\n    longitude: z.number().min(-180).max(180).optional(),\r\n    openingTime: z.string().min(1, \"Opening time is required\").optional(),\r\n    closingTime: z.string().min(1, \"Closing time is required\").optional(),\r\n    contactNumber: z.string().optional(),\r\n    images: z.array(z.string()).optional(),\r\n});\r\n\r\n/**\r\n * Verify admin token from Authorization header\r\n */\r\nfunction verifyAdminAuth(request: NextRequest): { valid: boolean; message?: string } {\r\n    const authHeader = request.headers.get('authorization');\r\n\r\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n        return { valid: false, message: \"No authorization token provided\" };\r\n    }\r\n\r\n    const token = authHeader.split(' ')[1];\r\n\r\n    try {\r\n        // Decode JWT to verify it's an admin token\r\n        const base64Url = token.split('.')[1];\r\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n        const jsonPayload = decodeURIComponent(\r\n            atob(base64)\r\n                .split('')\r\n                .map((c) => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))\r\n                .join('')\r\n        );\r\n        const payload = JSON.parse(jsonPayload);\r\n\r\n        if (payload.role !== 'admin') {\r\n            return { valid: false, message: \"Unauthorized: Admin access required\" };\r\n        }\r\n\r\n        return { valid: true };\r\n    } catch (error) {\r\n        return { valid: false, message: \"Invalid token\" };\r\n    }\r\n}\r\n\r\n/**\r\n * PUT /api/v1/admin/stores/[id]\r\n * Update an existing store\r\n */\r\nexport const PUT = withLoggingAndErrorHandling(async (\r\n    request: NextRequest,\r\n    context: { params: Promise<{ id: string }> }\r\n) => {\r\n    // Verify admin authentication\r\n    const authCheck = verifyAdminAuth(request);\r\n    if (!authCheck.valid) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: authCheck.message\r\n        }, { status: HttpStatus.UNAUTHORIZED });\r\n    }\r\n\r\n    const { id } = await context.params;\r\n\r\n    // Validate MongoDB ObjectId\r\n    if (!Types.ObjectId.isValid(id)) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: \"Invalid store ID\"\r\n        }, { status: HttpStatus.BAD_REQUEST });\r\n    }\r\n\r\n    const body = await request.json();\r\n    const validated = updateStoreSchema.safeParse(body);\r\n\r\n    if (!validated.success) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: \"Invalid store data\",\r\n            error: validated.error.issues\r\n        }, { status: HttpStatus.BAD_REQUEST });\r\n    }\r\n\r\n    const updateData: Record<string, unknown> = { ...validated.data };\r\n\r\n    // If latitude or longitude is provided, update the GeoJSON location\r\n    if (validated.data.latitude !== undefined || validated.data.longitude !== undefined) {\r\n        // Get existing store to merge coordinates\r\n        const existingStore = await storeRepo.findById(new Types.ObjectId(id));\r\n\r\n        if (!existingStore) {\r\n            return NextResponse.json({\r\n                success: false,\r\n                message: \"Store not found\"\r\n            }, { status: HttpStatus.NOT_FOUND });\r\n        }\r\n\r\n        const lat = validated.data.latitude ?? existingStore.latitude;\r\n        const lng = validated.data.longitude ?? existingStore.longitude;\r\n\r\n        updateData.latitude = lat;\r\n        updateData.longitude = lng;\r\n        updateData.location = {\r\n            coordinates: {\r\n                type: \"Point\",\r\n                coordinates: [lng, lat]\r\n            }\r\n        };\r\n    }\r\n\r\n    const updatedStore = await storeRepo.update(id, updateData);\r\n\r\n    if (!updatedStore) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: \"Store not found\"\r\n        }, { status: HttpStatus.NOT_FOUND });\r\n    }\r\n\r\n    return NextResponse.json({\r\n        success: true,\r\n        message: \"Store updated successfully\",\r\n        data: updatedStore\r\n    }, { status: HttpStatus.OK });\r\n});\r\n\r\n/**\r\n * DELETE /api/v1/admin/stores/[id]\r\n * Delete a store\r\n */\r\nexport const DELETE = withLoggingAndErrorHandling(async (\r\n    request: NextRequest,\r\n    context: { params: Promise<{ id: string }> }\r\n) => {\r\n    // Verify admin authentication\r\n    const authCheck = verifyAdminAuth(request);\r\n    if (!authCheck.valid) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: authCheck.message\r\n        }, { status: HttpStatus.UNAUTHORIZED });\r\n    }\r\n\r\n    const { id } = await context.params;\r\n\r\n    // Validate MongoDB ObjectId\r\n    if (!Types.ObjectId.isValid(id)) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: \"Invalid store ID\"\r\n        }, { status: HttpStatus.BAD_REQUEST });\r\n    }\r\n\r\n    await storeRepo.deleteOne({ _id: new Types.ObjectId(id) });\r\n\r\n    return NextResponse.json({\r\n        success: true,\r\n        message: \"Store deleted successfully\"\r\n    }, { status: HttpStatus.OK });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\api\\v1\\admin\\stores\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":52,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":52,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { HttpStatus } from \"@/constants/status.constant\";\r\nimport { StoreRepository } from \"@/repository/store.repository\";\r\nimport { withLoggingAndErrorHandling } from \"@/utils/decorator.utilt\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { z } from \"zod\";\r\n\r\nconst storeRepo = new StoreRepository();\r\n\r\n// Schema for creating a store\r\nconst createStoreSchema = z.object({\r\n    name: z.string().min(1, \"Store name is required\").trim(),\r\n    description: z.string().optional(),\r\n    address: z.string().min(1, \"Address is required\"),\r\n    district: z.string().min(1, \"District is required\"),\r\n    latitude: z.number().min(-90).max(90),\r\n    longitude: z.number().min(-180).max(180),\r\n    openingTime: z.string().min(1, \"Opening time is required\"),\r\n    closingTime: z.string().min(1, \"Closing time is required\"),\r\n    contactNumber: z.string().optional(),\r\n    images: z.array(z.string()).optional(),\r\n});\r\n\r\n/**\r\n * Verify admin token from Authorization header\r\n */\r\nfunction verifyAdminAuth(request: NextRequest): { valid: boolean; message?: string } {\r\n    const authHeader = request.headers.get('authorization');\r\n\r\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n        return { valid: false, message: \"No authorization token provided\" };\r\n    }\r\n\r\n    const token = authHeader.split(' ')[1];\r\n\r\n    try {\r\n        // Decode JWT to verify it's an admin token\r\n        const base64Url = token.split('.')[1];\r\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n        const jsonPayload = decodeURIComponent(\r\n            atob(base64)\r\n                .split('')\r\n                .map((c) => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))\r\n                .join('')\r\n        );\r\n        const payload = JSON.parse(jsonPayload);\r\n\r\n        if (payload.role !== 'admin') {\r\n            return { valid: false, message: \"Unauthorized: Admin access required\" };\r\n        }\r\n\r\n        return { valid: true };\r\n    } catch (error) {\r\n        return { valid: false, message: \"Invalid token\" };\r\n    }\r\n}\r\n\r\n/**\r\n * POST /api/v1/admin/stores\r\n * Create a new store\r\n */\r\nexport const POST = withLoggingAndErrorHandling(async (request: NextRequest) => {\r\n    // Verify admin authentication\r\n    const authCheck = verifyAdminAuth(request);\r\n    if (!authCheck.valid) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: authCheck.message\r\n        }, { status: HttpStatus.UNAUTHORIZED });\r\n    }\r\n\r\n    const body = await request.json();\r\n    const validated = createStoreSchema.safeParse(body);\r\n\r\n    if (!validated.success) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: \"Invalid store data\",\r\n            error: validated.error.issues\r\n        }, { status: HttpStatus.BAD_REQUEST });\r\n    }\r\n\r\n    const { latitude, longitude, ...storeData } = validated.data;\r\n\r\n    // Create store with GeoJSON location format\r\n    const newStore = await storeRepo.create({\r\n        ...storeData,\r\n        latitude,\r\n        longitude,\r\n        location: {\r\n            coordinates: {\r\n                type: \"Point\",\r\n                coordinates: [longitude, latitude]\r\n            }\r\n        }\r\n    });\r\n\r\n    return NextResponse.json({\r\n        success: true,\r\n        message: \"Store created successfully\",\r\n        data: newStore\r\n    }, { status: HttpStatus.CREATED });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\api\\v1\\admin\\vehicles\\[id]\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":55,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":55,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":113,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3797,3800],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3797,3800],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { HttpStatus } from \"@/constants/status.constant\";\r\nimport { VehicleRepository } from \"@/repository/vehicle.repository\";\r\nimport { withLoggingAndErrorHandling } from \"@/utils/decorator.utilt\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { z } from \"zod\";\r\nimport { Types } from \"mongoose\";\r\n\r\nconst vehicleRepo = new VehicleRepository();\r\n\r\n// Schema for updating a vehicle\r\nconst updateVehicleSchema = z.object({\r\n    store: z.string().optional(),\r\n    name: z.string().min(1, \"Name is required\").optional(),\r\n    description: z.string().optional(),\r\n    brand: z.string().min(1, \"Brand is required\").optional(),\r\n    modelYear: z.number().optional(),\r\n    fuelType: z.enum([\"petrol\", \"diesel\", \"electric\"]).optional(),\r\n    pricePerHour: z.number().min(0).optional(),\r\n    pricePerDay: z.number().optional(),\r\n    mileage: z.number().optional(),\r\n    licensePlate: z.string().min(1).optional(),\r\n    image: z.array(z.string()).optional(),\r\n    isActive: z.boolean().optional(),\r\n});\r\n\r\n/**\r\n * Verify admin token from Authorization header\r\n */\r\nfunction verifyAdminAuth(request: NextRequest): { valid: boolean; message?: string } {\r\n    const authHeader = request.headers.get('authorization');\r\n\r\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n        return { valid: false, message: \"No authorization token provided\" };\r\n    }\r\n\r\n    const token = authHeader.split(' ')[1];\r\n\r\n    try {\r\n        // Decode JWT to verify it's an admin token\r\n        const base64Url = token.split('.')[1];\r\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n        const jsonPayload = decodeURIComponent(\r\n            atob(base64)\r\n                .split('')\r\n                .map((c) => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))\r\n                .join('')\r\n        );\r\n        const payload = JSON.parse(jsonPayload);\r\n\r\n        if (payload.role !== 'admin') {\r\n            return { valid: false, message: \"Unauthorized: Admin access required\" };\r\n        }\r\n\r\n        return { valid: true };\r\n    } catch (error) {\r\n        return { valid: false, message: \"Invalid token\" };\r\n    }\r\n}\r\n\r\n/**\r\n * PUT /api/v1/admin/vehicles/[id]\r\n * Update an existing vehicle\r\n */\r\nexport const PUT = withLoggingAndErrorHandling(async (\r\n    request: NextRequest,\r\n    context: { params: Promise<{ id: string }> }\r\n) => {\r\n    // Verify admin authentication\r\n    const authCheck = verifyAdminAuth(request);\r\n    if (!authCheck.valid) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: authCheck.message\r\n        }, { status: HttpStatus.UNAUTHORIZED });\r\n    }\r\n\r\n    const { id } = await context.params;\r\n\r\n    // Validate MongoDB ObjectId\r\n    if (!Types.ObjectId.isValid(id)) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: \"Invalid vehicle ID\"\r\n        }, { status: HttpStatus.BAD_REQUEST });\r\n    }\r\n\r\n    const body = await request.json();\r\n    const validated = updateVehicleSchema.safeParse(body);\r\n\r\n    if (!validated.success) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: \"Invalid vehicle data\",\r\n            error: validated.error.issues\r\n        }, { status: HttpStatus.BAD_REQUEST });\r\n    }\r\n\r\n    try {\r\n        const updatedVehicle = await vehicleRepo.update(id, validated.data);\r\n\r\n        if (!updatedVehicle) {\r\n            return NextResponse.json({\r\n                success: false,\r\n                message: \"Vehicle not found\"\r\n            }, { status: HttpStatus.NOT_FOUND });\r\n        }\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            message: \"Vehicle updated successfully\",\r\n            data: updatedVehicle\r\n        }, { status: HttpStatus.OK });\r\n    } catch (error: any) {\r\n        if (error.code === 11000) {\r\n             return NextResponse.json({\r\n                success: false,\r\n                message: \"License plate must be unique\",\r\n            }, { status: HttpStatus.CONFLICT });\r\n        }\r\n        throw error;\r\n    }\r\n});\r\n\r\n/**\r\n * DELETE /api/v1/admin/vehicles/[id]\r\n * Delete a vehicle\r\n */\r\nexport const DELETE = withLoggingAndErrorHandling(async (\r\n    request: NextRequest,\r\n    context: { params: Promise<{ id: string }> }\r\n) => {\r\n    // Verify admin authentication\r\n    const authCheck = verifyAdminAuth(request);\r\n    if (!authCheck.valid) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: authCheck.message\r\n        }, { status: HttpStatus.UNAUTHORIZED });\r\n    }\r\n\r\n    const { id } = await context.params;\r\n\r\n    // Validate MongoDB ObjectId\r\n    if (!Types.ObjectId.isValid(id)) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: \"Invalid vehicle ID\"\r\n        }, { status: HttpStatus.BAD_REQUEST });\r\n    }\r\n\r\n    await vehicleRepo.deleteOne({ _id: new Types.ObjectId(id) });\r\n\r\n    return NextResponse.json({\r\n        success: true,\r\n        message: \"Vehicle deleted successfully\"\r\n    }, { status: HttpStatus.OK });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\api\\v1\\admin\\vehicles\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":54,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":120,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4087,4090],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4087,4090],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { HttpStatus } from \"@/constants/status.constant\";\r\nimport { VehicleRepository } from \"@/repository/vehicle.repository\";\r\nimport { withLoggingAndErrorHandling } from \"@/utils/decorator.utilt\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { z } from \"zod\";\r\n\r\nconst vehicleRepo = new VehicleRepository();\r\n\r\n// Schema for creating a vehicle\r\nconst createVehicleSchema = z.object({\r\n    store: z.string().min(1, \"Store ID is required\"),\r\n    name: z.string().min(1, \"Name is required\"),\r\n    description: z.string().optional(),\r\n    brand: z.string().min(1, \"Brand is required\"),\r\n    modelYear: z.number().optional(),\r\n    fuelType: z.enum([\"petrol\", \"diesel\", \"electric\"]),\r\n    pricePerHour: z.number().min(0, \"Price per hour must be positive\"),\r\n    pricePerDay: z.number().optional(),\r\n    mileage: z.number().optional(),\r\n    licensePlate: z.string().min(1, \"License plate is required\"),\r\n    image: z.array(z.string()).optional(),\r\n    isActive: z.boolean().optional(),\r\n});\r\n\r\n/**\r\n * Verify admin token from Authorization header\r\n */\r\nfunction verifyAdminAuth(request: NextRequest): { valid: boolean; message?: string } {\r\n    const authHeader = request.headers.get('authorization');\r\n\r\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n        return { valid: false, message: \"No authorization token provided\" };\r\n    }\r\n\r\n    const token = authHeader.split(' ')[1];\r\n\r\n    try {\r\n        // Decode JWT to verify it's an admin token\r\n        const base64Url = token.split('.')[1];\r\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n        const jsonPayload = decodeURIComponent(\r\n            atob(base64)\r\n                .split('')\r\n                .map((c) => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))\r\n                .join('')\r\n        );\r\n        const payload = JSON.parse(jsonPayload);\r\n\r\n        if (payload.role !== 'admin') {\r\n            return { valid: false, message: \"Unauthorized: Admin access required\" };\r\n        }\r\n\r\n        return { valid: true };\r\n    } catch (error) {\r\n        return { valid: false, message: \"Invalid token\" };\r\n    }\r\n}\r\n\r\n/**\r\n * GET /api/v1/admin/vehicles\r\n * Get all vehicles (for admin)\r\n */\r\nexport const GET = withLoggingAndErrorHandling(async (request: NextRequest) => {\r\n    // Verify admin authentication\r\n    const authCheck = verifyAdminAuth(request);\r\n    if (!authCheck.valid) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: authCheck.message\r\n        }, { status: HttpStatus.UNAUTHORIZED });\r\n    }\r\n\r\n    const vehicles = await vehicleRepo.find({});\r\n    // Populate store details if needed, but repository find might return raw docs.\r\n    // Assuming simple find for now.\r\n\r\n    return NextResponse.json({\r\n        success: true,\r\n        message: \"Vehicles retrieved successfully\",\r\n        data: vehicles\r\n    }, { status: HttpStatus.OK });\r\n});\r\n\r\n/**\r\n * POST /api/v1/admin/vehicles\r\n * Create a new vehicle\r\n */\r\nexport const POST = withLoggingAndErrorHandling(async (request: NextRequest) => {\r\n    // Verify admin authentication\r\n    const authCheck = verifyAdminAuth(request);\r\n    if (!authCheck.valid) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: authCheck.message\r\n        }, { status: HttpStatus.UNAUTHORIZED });\r\n    }\r\n\r\n    const body = await request.json();\r\n    const validated = createVehicleSchema.safeParse(body);\r\n\r\n    if (!validated.success) {\r\n        return NextResponse.json({\r\n            success: false,\r\n            message: \"Invalid vehicle data\",\r\n            error: validated.error.issues\r\n        }, { status: HttpStatus.BAD_REQUEST });\r\n    }\r\n\r\n    try {\r\n        const newVehicle = await vehicleRepo.create({\r\n            ...validated.data,\r\n            isActive: validated.data.isActive ?? true\r\n        });\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            message: \"Vehicle created successfully\",\r\n            data: newVehicle\r\n        }, { status: HttpStatus.CREATED });\r\n    } catch (error: any) {\r\n        if (error.code === 11000) {\r\n             return NextResponse.json({\r\n                success: false,\r\n                message: \"License plate must be unique\",\r\n            }, { status: HttpStatus.CONFLICT });\r\n        }\r\n        throw error;\r\n    }\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\components\\landing\\desktop-landing.page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'stores' is assigned a value but never used.","line":37,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'locationError' is assigned a value but never used.","line":40,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport Image from \"next/image\";\r\nimport { useState, useEffect, useRef } from \"react\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { useTheme } from \"next-themes\";\r\nimport PickupSelector from \"./pickup\";\r\n\r\nimport { useRouter } from \"next/navigation\";\r\nimport ROUTE_CONSTANTS from \"@/constants/routeConstants\";\r\nimport { IStore } from \"@/core/interface/model/IStore.model\";\r\n\r\n\r\nexport default function DesktopLandingPage() {\r\n    const { resolvedTheme, setTheme } = useTheme();\r\n    const router = useRouter();\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    // Pickup state\r\n    const [pickupDate, setPickupDate] = useState<Date | null>(null);\r\n    const [pickupTime, setPickupTime] = useState<string | null>(null);\r\n\r\n    // Dropoff state\r\n    const [dropoffDate, setDropoffDate] = useState<Date | null>(null);\r\n    const [dropoffTime, setDropoffTime] = useState<string | null>(null);\r\n\r\n    // Validation errors\r\n    const [pickupError, setPickupError] = useState<string>(\"\");\r\n    const [dropoffError, setDropoffError] = useState<string>(\"\");\r\n\r\n    // Location state\r\n    const [location, setLocation] = useState<{ lat: number; lng: number } | null>(null);\r\n    const [isRequestingLocation, setIsRequestingLocation] = useState(false);\r\n\r\n    // Store state\r\n    const [stores, setStores] = useState<IStore[]>([]);\r\n    const [selectedStore, setSelectedStore] = useState<IStore | null>(null);\r\n    const [storesLoading, setStoresLoading] = useState(true);\r\n    const [locationError, setLocationError] = useState<string>(\"\");\r\n\r\n    // Ref for scrolling to button\r\n    const buttonRef = useRef<HTMLButtonElement>(null);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        // Fetch stores on mount\r\n        fetchStores();\r\n    }, []);\r\n\r\n    const fetchStores = async () => {\r\n        try {\r\n            const response = await fetch('/api/v1/stores');\r\n            const data = await response.json();\r\n            if (data.success && data.data && data.data.length > 0) {\r\n                setStores(data.data);\r\n                // Auto-select first store as default\r\n                setSelectedStore(data.data[0]);\r\n            }\r\n        } catch (error) {\r\n            console.error('Failed to fetch stores:', error);\r\n        } finally {\r\n            setStoresLoading(false);\r\n        }\r\n    };\r\n\r\n    if (!mounted) return null;\r\n\r\n    const getLocation = async (): Promise<{ lat: number; lng: number } | null> => {\r\n        if (!navigator.geolocation) {\r\n            setLocationError(\"Geolocation is not supported by your browser\");\r\n            return null;\r\n        }\r\n\r\n        setIsRequestingLocation(true);\r\n        setLocationError(\"\");\r\n\r\n        return new Promise((resolve) => {\r\n            navigator.geolocation.getCurrentPosition(\r\n                (position) => {\r\n                    const lat = position.coords.latitude;\r\n                    const lng = position.coords.longitude;\r\n                    setLocation({ lat, lng });\r\n                    setIsRequestingLocation(false);\r\n                    resolve({ lat, lng });\r\n                },\r\n                (error) => {\r\n                    setIsRequestingLocation(false);\r\n                    let errorMsg = \"Unable to get your location\";\r\n                    switch (error.code) {\r\n                        case error.PERMISSION_DENIED:\r\n                            errorMsg = \"Location permission denied. You'll see all available vehicles.\";\r\n                            break;\r\n                        case error.POSITION_UNAVAILABLE:\r\n                            errorMsg = \"Location unavailable. You'll see all available vehicles.\";\r\n                            break;\r\n                        case error.TIMEOUT:\r\n                            errorMsg = \"Location request timed out. You'll see all available vehicles.\";\r\n                            break;\r\n                    }\r\n                    setLocationError(errorMsg);\r\n                    resolve(null);\r\n                }\r\n            );\r\n        });\r\n    };\r\n\r\n    const validateAndNavigate = async () => {\r\n        // Reset errors\r\n        setPickupError(\"\");\r\n        setDropoffError(\"\");\r\n        setLocationError(\"\");\r\n\r\n        let isValid = true;\r\n\r\n        // Validate pickup\r\n        if (!pickupDate || !pickupTime) {\r\n            setPickupError(\"Please select both pickup date and time\");\r\n            isValid = false;\r\n        }\r\n\r\n        // Validate dropoff\r\n        if (!dropoffDate || !dropoffTime) {\r\n            setDropoffError(\"Please select both dropoff date and time\");\r\n            isValid = false;\r\n        }\r\n\r\n        if (!isValid) return;\r\n\r\n        // Create full datetime objects for validation\r\n        const pickupDateTime = new Date(pickupDate!);\r\n        const [pickupHour, pickupMinute] = pickupTime!.split(\":\").map(Number);\r\n        pickupDateTime.setHours(pickupHour, pickupMinute, 0, 0);\r\n\r\n        const dropoffDateTime = new Date(dropoffDate!);\r\n        const [dropoffHour, dropoffMinute] = dropoffTime!.split(\":\").map(Number);\r\n        dropoffDateTime.setHours(dropoffHour, dropoffMinute, 0, 0);\r\n\r\n        const now = new Date();\r\n\r\n        // Validate pickup is not in the past\r\n        if (pickupDateTime <= now) {\r\n            setPickupError(\"Pickup time cannot be in the past\");\r\n            isValid = false;\r\n        }\r\n\r\n        // Validate dropoff is after pickup\r\n        if (dropoffDateTime <= pickupDateTime) {\r\n            setDropoffError(\"Drop-off time must be later than pickup time\");\r\n            isValid = false;\r\n        }\r\n\r\n        if (!isValid) return;\r\n\r\n        // Get location (optional)\r\n        let finalLocation = location;\r\n        if (!finalLocation) {\r\n            finalLocation = await getLocation();\r\n        }\r\n\r\n        // Build query params\r\n        const params = new URLSearchParams({\r\n            startTime: pickupDateTime.toISOString(),\r\n            endTime: dropoffDateTime.toISOString(),\r\n            page: \"1\",\r\n            limit: \"10\"\r\n        });\r\n\r\n        // Add storeId (required for home page)\r\n        if (selectedStore) {\r\n            params.append(\"storeId\", selectedStore._id.toString());\r\n        }\r\n\r\n        // Add location params only if available\r\n        if (finalLocation) {\r\n            params.append(\"latitude\", finalLocation.lat.toString());\r\n            params.append(\"longitude\", finalLocation.lng.toString());\r\n            params.append(\"radiusKm\", \"50\"); // Default radius\r\n        }\r\n\r\n        // Navigate to vehicle listing page\r\n        router.push(`${ROUTE_CONSTANTS.HOME}?${params.toString()}`);\r\n    };\r\n\r\n\r\n    // Use resolvedTheme for consistent server/client rendering\r\n    const currentTheme = mounted ? resolvedTheme : \"light\";\r\n    const isLight = currentTheme === \"light\";\r\n\r\n    return (\r\n        <div className=\"relative w-full min-h-screen bg-white dark:bg-[#0B0A1B]\">\r\n            {/* Desktop Layout - Split Screen */}\r\n            <div className=\"flex h-screen\">\r\n                {/* Left Side - Form */}\r\n                <div className=\"w-1/2 flex flex-col justify-center items-center px-12 bg-white dark:bg-[#0B0A1B]\">\r\n                    {/* Logo with yellow background */}\r\n                    <div className=\"absolute top-8 left-8 bg-[#F4AA05] rounded-3xl p-3\">\r\n                        <Image\r\n                            src=\"/logo.png\"\r\n                            alt=\"TooBikes Logo\"\r\n                            width={60}\r\n                            height={60}\r\n                            className=\"object-contain\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"w-full max-w-md\">\r\n                        <h1 className=\"text-4xl font-bold mb-2 text-gray-900 dark:text-white\">\r\n                            Find the right ride,\r\n                        </h1>\r\n                        <h1 className=\"text-4xl font-bold mb-8 text-gray-900 dark:text-white\">\r\n                            every time\r\n                        </h1>\r\n\r\n                        <div className=\"space-y-6\">\r\n                            <div>\r\n                                <h4 className=\"font-medium mb-3 text-gray-700 dark:text-gray-300\">Pickup date & time</h4>\r\n                                <PickupSelector\r\n                                    pickup={true}\r\n                                    date={pickupDate}\r\n                                    time={pickupTime}\r\n                                    onDateChange={setPickupDate}\r\n                                    onTimeChange={setPickupTime}\r\n                                    error={pickupError}\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <h4 className=\"font-medium mb-3 text-gray-700 dark:text-gray-300\">Drop date & time</h4>\r\n                                <PickupSelector\r\n                                    pickup={false}\r\n                                    date={dropoffDate}\r\n                                    time={dropoffTime}\r\n                                    onDateChange={setDropoffDate}\r\n                                    onTimeChange={setDropoffTime}\r\n                                    error={dropoffError}\r\n                                    minDate={pickupDate}\r\n                                />\r\n                            </div>\r\n\r\n                            <Button\r\n                                ref={buttonRef}\r\n                                onClick={validateAndNavigate}\r\n                                disabled={isRequestingLocation || storesLoading || !selectedStore || !pickupDate || !pickupTime || !dropoffDate || !dropoffTime}\r\n                                className=\"w-full h-14 rounded-full bg-[#F4AA05] hover:bg-[#cf9002] text-black font-semibold text-lg disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            >\r\n                                {isRequestingLocation ? \"Getting location...\" : storesLoading ? \"Loading...\" : \"Let's Drive\"}\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Right Side - Image with Padding */}\r\n                <div className=\"w-1/2 relative bg-white dark:bg-[#0B0A1B] flex items-center justify-center p-8\">\r\n                    {/* Theme Toggle - Top Right Corner */}\r\n                    <button\r\n                        onClick={() => setTheme(isLight ? \"dark\" : \"light\")}\r\n                        className=\"absolute top-8 right-8 z-10 p-3 rounded-full \r\n                            bg-black/70 text-white dark:bg-white/80 dark:text-black \r\n                            backdrop-blur shadow hover:scale-110 transition-transform\"\r\n                        aria-label=\"Toggle theme\"\r\n                    >\r\n                        {isLight ? (\r\n                            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z\" />\r\n                            </svg>\r\n                        ) : (\r\n                            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z\" />\r\n                            </svg>\r\n                        )}\r\n                    </button>\r\n\r\n                    {/* Image Container with Padding and Rounded Corners */}\r\n                    <div className=\"relative w-full h-[calc(100vh-6rem)] rounded-3xl overflow-hidden\">\r\n                        <Image\r\n                            src={isLight ? \"/landing/home_desktop_light.png\" : \"/landing/home_desktop_dark.png\"}\r\n                            alt=\"Scooter riders in city\"\r\n                            fill\r\n                            className=\"object-contain  rounded-xl\"\r\n                            priority\r\n                            suppressHydrationWarning\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\components\\landing\\mobile-landing.page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'stores' is assigned a value but never used.","line":43,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":43,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'locationError' is assigned a value but never used.","line":46,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":46,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport Image from \"next/image\";\r\nimport { useState, useEffect, useRef } from \"react\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { useTheme } from \"next-themes\";\r\nimport PickupSelector from \"./pickup\";\r\nimport { ThemeToggle } from \"../ThemeToggle\";\r\n\r\nimport { useRouter } from \"next/navigation\";\r\nimport ROUTE_CONSTANTS from \"@/constants/routeConstants\";\r\nimport { IStore } from \"@/core/interface/model/IStore.model\";\r\n\r\n\r\nexport default function MobileLandingPage() {\r\n  const { resolvedTheme } = useTheme();\r\n  const router = useRouter();\r\n  const [mounted, setMounted] = useState(false);\r\n\r\n  // Prevent hydration mismatch\r\n  useEffect(() => {\r\n    setMounted(true);\r\n  }, []);\r\n\r\n  // Pickup state\r\n  const [pickupDate, setPickupDate] = useState<Date | null>(null);\r\n  const [pickupTime, setPickupTime] = useState<string | null>(null);\r\n\r\n  // Dropoff state\r\n  const [dropoffDate, setDropoffDate] = useState<Date | null>(null);\r\n  const [dropoffTime, setDropoffTime] = useState<string | null>(null);\r\n\r\n  // Validation errors\r\n  const [pickupError, setPickupError] = useState<string>(\"\");\r\n  const [dropoffError, setDropoffError] = useState<string>(\"\");\r\n\r\n  // Location state\r\n  const [location, setLocation] = useState<{ lat: number; lng: number } | null>(null);\r\n  const [isRequestingLocation, setIsRequestingLocation] = useState(false);\r\n\r\n  // Store state\r\n  const [stores, setStores] = useState<IStore[]>([]);\r\n  const [selectedStore, setSelectedStore] = useState<IStore | null>(null);\r\n  const [storesLoading, setStoresLoading] = useState(true);\r\n  const [locationError, setLocationError] = useState<string>(\"\");\r\n\r\n  // Ref for scrolling to button\r\n  const buttonRef = useRef<HTMLButtonElement>(null);\r\n\r\n  // Scroll handler for when date/time pickers open\r\n  const scrollToButton = () => {\r\n    setTimeout(() => {\r\n      buttonRef.current?.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\r\n    }, 100);\r\n  };\r\n\r\n  useEffect(() => {\r\n    setMounted(true);\r\n    // Fetch stores on mount\r\n    fetchStores();\r\n  }, []);\r\n\r\n  const fetchStores = async () => {\r\n    try {\r\n      const response = await fetch('/api/v1/stores');\r\n      const data = await response.json();\r\n      if (data.success && data.data && data.data.length > 0) {\r\n        setStores(data.data);\r\n        // Auto-select first store as default\r\n        setSelectedStore(data.data[0]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch stores:', error);\r\n    } finally {\r\n      setStoresLoading(false);\r\n    }\r\n  };\r\n\r\n  if (!mounted) return null;\r\n\r\n  const getLocation = async (): Promise<{ lat: number; lng: number } | null> => {\r\n    if (!navigator.geolocation) {\r\n      setLocationError(\"Geolocation is not supported by your browser\");\r\n      return null;\r\n    }\r\n\r\n    setIsRequestingLocation(true);\r\n    setLocationError(\"\");\r\n\r\n    return new Promise((resolve) => {\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          const lat = position.coords.latitude;\r\n          const lng = position.coords.longitude;\r\n          setLocation({ lat, lng });\r\n          setIsRequestingLocation(false);\r\n          resolve({ lat, lng });\r\n        },\r\n        (error) => {\r\n          setIsRequestingLocation(false);\r\n          let errorMsg = \"Unable to get your location\";\r\n          switch (error.code) {\r\n            case error.PERMISSION_DENIED:\r\n              errorMsg = \"Location permission denied. You'll see all available vehicles.\";\r\n              break;\r\n            case error.POSITION_UNAVAILABLE:\r\n              errorMsg = \"Location unavailable. You'll see all available vehicles.\";\r\n              break;\r\n            case error.TIMEOUT:\r\n              errorMsg = \"Location request timed out. You'll see all available vehicles.\";\r\n              break;\r\n          }\r\n          setLocationError(errorMsg);\r\n          resolve(null);\r\n        }\r\n      );\r\n    });\r\n  };\r\n\r\n  const validateAndNavigate = async () => {\r\n    // Reset errors\r\n    setPickupError(\"\");\r\n    setDropoffError(\"\");\r\n    setLocationError(\"\");\r\n\r\n    let isValid = true;\r\n\r\n    // Validate pickup\r\n    if (!pickupDate || !pickupTime) {\r\n      setPickupError(\"Please select both pickup date and time\");\r\n      isValid = false;\r\n    }\r\n\r\n    // Validate dropoff\r\n    if (!dropoffDate || !dropoffTime) {\r\n      setDropoffError(\"Please select both dropoff date and time\");\r\n      isValid = false;\r\n    }\r\n\r\n    if (!isValid) return;\r\n\r\n    // Create full datetime objects for validation\r\n    const pickupDateTime = new Date(pickupDate!);\r\n    const [pickupHour, pickupMinute] = pickupTime!.split(\":\").map(Number);\r\n    pickupDateTime.setHours(pickupHour, pickupMinute, 0, 0);\r\n\r\n    const dropoffDateTime = new Date(dropoffDate!);\r\n    const [dropoffHour, dropoffMinute] = dropoffTime!.split(\":\").map(Number);\r\n    dropoffDateTime.setHours(dropoffHour, dropoffMinute, 0, 0);\r\n\r\n    const now = new Date();\r\n\r\n    // Validate pickup is not in the past\r\n    if (pickupDateTime <= now) {\r\n      setPickupError(\"Pickup time cannot be in the past\");\r\n      isValid = false;\r\n    }\r\n\r\n    // Validate dropoff is after pickup\r\n    if (dropoffDateTime <= pickupDateTime) {\r\n      setDropoffError(\"Drop-off time must be later than pickup time\");\r\n      isValid = false;\r\n    }\r\n\r\n    if (!isValid) return;\r\n\r\n    // Get location (optional)\r\n    let finalLocation = location;\r\n    if (!finalLocation) {\r\n      finalLocation = await getLocation();\r\n    }\r\n\r\n    // Build query params\r\n    const params = new URLSearchParams({\r\n      startTime: pickupDateTime.toISOString(),\r\n      endTime: dropoffDateTime.toISOString(),\r\n      page: \"1\",\r\n      limit: \"10\"\r\n    });\r\n\r\n    // Add storeId (required for home page)\r\n    if (selectedStore) {\r\n      params.append(\"storeId\", selectedStore._id.toString());\r\n    }\r\n\r\n    // Add location params only if available\r\n    if (finalLocation) {\r\n      params.append(\"latitude\", finalLocation.lat.toString());\r\n      params.append(\"longitude\", finalLocation.lng.toString());\r\n      params.append(\"radiusKm\", \"50\"); // Default radius\r\n    }\r\n\r\n    // Navigate to vehicle listing page\r\n    router.push(`${ROUTE_CONSTANTS.HOME}?${params.toString()}`);\r\n  };\r\n\r\n\r\n  // Use resolvedTheme for consistent server/client rendering\r\n  const currentTheme = mounted ? resolvedTheme : \"light\";\r\n  const isLight = currentTheme === \"light\";\r\n\r\n  return (\r\n    <div className=\"relative w-full min-h-screen bg-white dark:bg-[#0B0A1B]\">\r\n      <ThemeToggle />\r\n\r\n      {/* FIXED RESPONSIVE HEADER IMAGE */}\r\n      <div className=\"fixed top-0 left-0 w-full h-[clamp(320px,45vh,500px)] z-0\">\r\n        <Image\r\n          src={isLight ? \"/day_wm.png\" : \"/night_wm.png\"}\r\n          alt=\"Scooter\"\r\n          fill\r\n          className=\"object-cover object-center\"\r\n          priority\r\n          suppressHydrationWarning\r\n        />\r\n        {/* Logo in top-left corner */}\r\n        <div className=\"absolute top-3 left-3 z-10 bg-[#F4AA05] rounded-xl p-1.5 md:p-2 md:rounded-2xl\">\r\n          <Image\r\n            src=\"/logo.png\"\r\n            alt=\"TooBikes Logo\"\r\n            width={32}\r\n            height={32}\r\n            className=\"object-contain md:w-12 md:h-12\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n\r\n\r\n      {/* SCROLL CONTENT BELOW THE HEADER IMAGE */}\r\n      <div className=\"relative z-10 pt-[clamp(310px,42vh,490px)] flex flex-col items-center pb-0\">\r\n        <Card className=\"w-full max-w-xl rounded-t-3xl rounded-b-none border-none shadow-none dark:bg-[#0B0A1B] bg-white\">\r\n          <CardContent className=\"pt-4 px-6 pb-10\">\r\n            <h2 className=\"text-[26px] font-medium\">\r\n              Find the right ride, <br /> every time\r\n            </h2>\r\n\r\n            <h4 className=\"font-light m-3 mt-10\">Select your pick time</h4>\r\n            <PickupSelector\r\n              pickup={true}\r\n              date={pickupDate}\r\n              time={pickupTime}\r\n              onDateChange={setPickupDate}\r\n              onTimeChange={setPickupTime}\r\n              error={pickupError}\r\n              onOpen={scrollToButton}\r\n            />\r\n\r\n            <h4 className=\"font-light m-3\">Select your dropoff time</h4>\r\n            <PickupSelector\r\n              pickup={false}\r\n              date={dropoffDate}\r\n              time={dropoffTime}\r\n              onDateChange={setDropoffDate}\r\n              onTimeChange={setDropoffTime}\r\n              error={dropoffError}\r\n              minDate={pickupDate}\r\n              onOpen={scrollToButton}\r\n            />\r\n\r\n\r\n            <Button\r\n              ref={buttonRef}\r\n              onClick={validateAndNavigate}\r\n              disabled={isRequestingLocation || storesLoading || !selectedStore || !pickupDate || !pickupTime || !dropoffDate || !dropoffTime}\r\n              className=\"w-full h-12 rounded-full bg-[#F4AA05] hover:bg-[#cf9002] mt-24 text-black font-semibold text-lg disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {isRequestingLocation ? \"Getting location...\" : storesLoading ? \"Loading...\" : \"Let's Drive\"}\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Hafiz salman\\OneDrive\\Desktop\\ciltriq\\too-bikes-core\\app\\vehicle\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_userPhoneNumber' is assigned a value but never used.","line":38,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { use, useState, useEffect, useCallback } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport axiosInstance from \"@/lib/axios\";\r\nimport { AxiosError } from \"axios\";\r\nimport VehicleImageSlider from \"./(components)/VehicleImageSlider\";\r\nimport VehicleInfoCard from \"./(components)/VehicleInfoCard\";\r\nimport PickupDropSection from \"./(components)/PickupDropSection\";\r\nimport ReviewsSection from \"./(components)/ReviewsSection\";\r\nimport FAQAccordion from \"./(components)/FAQAccordion\";\r\nimport BottomCTA from \"./(components)/BottomCTA\";\r\nimport AuthModal from \"@/components/AuthModal\";\r\nimport LicenseUploadModal from \"@/components/LicenseUploadModal\";\r\nimport VehicleDetailSkeleton from \"./(components)/VehicleDetailSkeleton\";\r\nimport { IFAQ } from \"@/core/interface/model/IFaq.model\";\r\nimport { VehicleDetailResponse } from \"@/app/api/v1/available-vehicles/[id]/route\";\r\nimport { IStore } from \"@/core/interface/model/IStore.model\";\r\nimport { IVehicle } from \"@/core/interface/model/IVehicle.model\";\r\nimport { checkFavoriteStatus } from \"@/services/client/favorites.service\";\r\n\r\ninterface VehicleDetailPageProps {\r\n  params: Promise<{ id: string }>;\r\n}\r\n\r\nexport default function VehicleDetailPage({ params }: VehicleDetailPageProps) {\r\n  const { id } = use(params);\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n\r\n  // State management\r\n  const [vehicle, setVehicle] = useState<IVehicle | null>(null);\r\n  const [faqs, setFaqs] = useState<IFAQ[]>([]);\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [error, setError] = useState<string>(\"\");\r\n  const [isAuthModalOpen, setIsAuthModalOpen] = useState<boolean>(false);\r\n  const [isLicenseModalOpen, setIsLicenseModalOpen] = useState<boolean>(false);\r\n  const [_userPhoneNumber, _setUserPhoneNumber] = useState<string>(\"\");\r\n  const [isFavorite, setIsFavorite] = useState<boolean>(false);\r\n  const [authContext, setAuthContext] = useState<\"booking\" | \"favorite\">(\"booking\");\r\n\r\n  // Get pickup/drop details from URL params or use defaults\r\n  const pickupDateParam = searchParams.get(\"pickupDate\");\r\n  const pickupTimeParam = searchParams.get(\"pickupTime\");\r\n  const dropDateParam = searchParams.get(\"dropDate\");\r\n  const dropTimeParam = searchParams.get(\"dropTime\");\r\n\r\n  // Fetch vehicle details from API\r\n  const fetchVehicleDetails = useCallback(async () => {\r\n    if (!id) {\r\n      setError(\"Vehicle ID is required\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(\"\");\r\n\r\n    try {\r\n      const response = await axiosInstance.get<VehicleDetailResponse>(\r\n        `/api/v1/available-vehicles/${id}`\r\n      );\r\n\r\n      const data = response.data;\r\n\r\n      if (!data.success) {\r\n        if (data.error && Array.isArray(data.error)) {\r\n          const errorMessages = data.error\r\n            .map((err) => err.message || err.path?.join(\".\"))\r\n            .join(\", \");\r\n          setError(`Validation error: ${errorMessages}`);\r\n        } else {\r\n          setError(data.message || \"Failed to fetch vehicle details.\");\r\n        }\r\n        setVehicle(null);\r\n        setFaqs([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (!data.data || !data.data.vehicle) {\r\n        setError(\"Vehicle not found.\");\r\n        setVehicle(null);\r\n        setFaqs([]);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      setVehicle(data.data.vehicle);\r\n      setFaqs(data.data.FAQ || []);\r\n      setError(\"\");\r\n\r\n      // Check if user is authenticated and fetch favorite status\r\n      const token = localStorage.getItem(\"auth_token\");\r\n      if (token) {\r\n        try {\r\n          const favoriteResponse = await checkFavoriteStatus(id);\r\n          if (favoriteResponse.success && favoriteResponse.data) {\r\n            setIsFavorite(favoriteResponse.data.isFavorite);\r\n          }\r\n        } catch (error) {\r\n          // User not authenticated or error checking favorite status\r\n          // Silently fail - favorite will default to false\r\n          console.log(\"Could not check favorite status:\", error);\r\n        }\r\n      }\r\n    } catch (_err) {\r\n      const axiosError = _err as AxiosError<{\r\n        message?: string;\r\n        error?: Array<{ message?: string; path?: string[] }>;\r\n      }>;\r\n\r\n      let errorMessage = \"An error occurred while fetching vehicle details.\";\r\n\r\n      if (axiosError.response) {\r\n        const status = axiosError.response.status;\r\n        const errorData = axiosError.response.data;\r\n\r\n        if (errorData?.error && Array.isArray(errorData.error)) {\r\n          const errorMessages = errorData.error\r\n            .map((err) => err.message || err.path?.join(\".\"))\r\n            .join(\", \");\r\n          errorMessage = `Validation error: ${errorMessages}`;\r\n        } else if (errorData?.message) {\r\n          errorMessage = errorData.message;\r\n        } else if (status === 404) {\r\n          errorMessage = \"Vehicle not found.\";\r\n        } else if (status >= 500) {\r\n          errorMessage = `Server error (${status}). Please try again later.`;\r\n        }\r\n      } else if (axiosError.request) {\r\n        errorMessage = \"Network error. Please check your connection.\";\r\n      } else if (axiosError.message) {\r\n        errorMessage = axiosError.message;\r\n      }\r\n\r\n      setError(errorMessage);\r\n      setVehicle(null);\r\n      setFaqs([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [id]);\r\n\r\n  useEffect(() => {\r\n    fetchVehicleDetails();\r\n  }, [fetchVehicleDetails]);\r\n\r\n  // Default pickup/drop data\r\n  const pickupDate = pickupDateParam\r\n    ? new Date(pickupDateParam)\r\n    : new Date(Date.now() + 24 * 60 * 60 * 1000);\r\n  const pickupTime = pickupTimeParam || \"10:00 AM\";\r\n  const dropDate = dropDateParam\r\n    ? new Date(dropDateParam)\r\n    : new Date(Date.now() + 2 * 24 * 60 * 60 * 1000);\r\n  const dropTime = dropTimeParam || \"10:00 AM\";\r\n  const pickupLocation = ` ${(vehicle?.store as IStore)?.address || \"\"}`;\r\n  const dropLocation = ` ${(vehicle?.store as IStore)?.address || \"\"}`;\r\n\r\n  // Mock reviews (until reviews API is available)\r\n  const reviews = [\r\n    {\r\n      userName: \"John Doe\",\r\n      rating: 5,\r\n      comment: \"Great bike, very smooth ride. Highly recommended!\",\r\n      date: \"2 days ago\",\r\n    },\r\n    {\r\n      userName: \"Jane Smith\",\r\n      rating: 4,\r\n      comment: \"Good condition and easy to handle. Would rent again.\",\r\n      date: \"1 week ago\",\r\n    },\r\n    {\r\n      userName: \"Mike Johnson\",\r\n      rating: 5,\r\n      comment: \"Perfect for city rides. Excellent service!\",\r\n      date: \"2 weeks ago\",\r\n    },\r\n  ];\r\n\r\n  // Map FAQ items from API\r\n  const faqItems = faqs.map((faq) => ({\r\n    question: faq.question,\r\n    answer: faq.answer,\r\n  }));\r\n\r\n  const handleBookNow = async () => {\r\n    /**\r\n     * @salman \r\n     * never fail silently ensure that the user is indicated\r\n     */\r\n    if (!vehicle) return;\r\n\r\n    // Set context to booking\r\n    setAuthContext(\"booking\");\r\n\r\n    // Check if user is already authenticated\r\n    const token = localStorage.getItem(\"auth_token\");\r\n\r\n    if (token) {\r\n      try {\r\n        // Verify token with backend using axiosInstance (enables auto token refresh)\r\n        const response = await axiosInstance.get(\"/api/v1/auth/verify-token\");\r\n\r\n        if (response.data.success) {\r\n          // User is authenticated, get user info from token data\r\n          _setUserPhoneNumber(response.data.user?.phoneNumber || \"\");\r\n\r\n          // Check if user has already uploaded license\r\n          const licenseCheckResponse = await axiosInstance.get(\"/api/v1/license/check\");\r\n\r\n          if (licenseCheckResponse.data.success && licenseCheckResponse.data.hasLicense) {\r\n            // User has already uploaded license, navigate to review page\r\n            const reviewUrl = `/order-review?vehicleId=${id}&startTime=${encodeURIComponent(pickupDate.toISOString())}&endTime=${encodeURIComponent(dropDate.toISOString())}&totalAmount=${totalRent}`;\r\n            router.push(reviewUrl);\r\n            return;\r\n          }\r\n\r\n          // User hasn't uploaded license yet, show license modal\r\n          setIsLicenseModalOpen(true);\r\n          return;\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Token verification failed:\", error);\r\n        // Token is invalid or refresh failed, continue to show auth modal\r\n      }\r\n    }\r\n\r\n    // User is not authenticated or token is invalid, show auth modal\r\n    setIsAuthModalOpen(true);\r\n  };\r\n\r\n  const handleAuthModalClose = () => {\r\n    setIsAuthModalOpen(false);\r\n  };\r\n\r\n  const handleAuthComplete = async (phoneNumber: string, otp: string) => {\r\n    // Store phone number and close auth modal\r\n    console.log(\"Phone:\", phoneNumber, \"OTP:\", otp);\r\n    _setUserPhoneNumber(phoneNumber);\r\n    setIsAuthModalOpen(false);\r\n\r\n    // If auth was triggered by favorite button, don't redirect to booking flow\r\n    if (authContext === \"favorite\") {\r\n      // User is now authenticated, they can try favoriting again\r\n      return;\r\n    }\r\n\r\n    // Auth was triggered by booking flow, continue with booking\r\n    try {\r\n      // Check if user has already uploaded license\r\n      const licenseCheckResponse = await axiosInstance.get(\"/api/v1/license/check\");\r\n\r\n      if (licenseCheckResponse.data.success && licenseCheckResponse.data.hasLicense) {\r\n        // User has already uploaded license, navigate to review page\r\n        const reviewUrl = `/order-review?vehicleId=${id}&startTime=${encodeURIComponent(pickupDate.toISOString())}&endTime=${encodeURIComponent(dropDate.toISOString())}&totalAmount=${totalRent}`;\r\n        router.push(reviewUrl);\r\n        return;\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to check license status:\", error);\r\n      // Continue to show license modal on error\r\n    }\r\n\r\n    // User hasn't uploaded license yet, show license upload modal\r\n    setIsLicenseModalOpen(true);\r\n  };\r\n\r\n  const handleLicenseModalClose = () => {\r\n    setIsLicenseModalOpen(false);\r\n  };\r\n\r\n  const handleLicenseComplete = async (frontImage: File, backImage: File) => {\r\n    console.log(\"License uploaded:\", frontImage.name, backImage.name);\r\n    setIsLicenseModalOpen(false);\r\n\r\n    // Navigate to order review page with order details\r\n    const reviewUrl = `/order-review?vehicleId=${id}&startTime=${encodeURIComponent(pickupDate.toISOString())}&endTime=${encodeURIComponent(dropDate.toISOString())}&totalAmount=${totalRent}`;\r\n    router.push(reviewUrl);\r\n  };\r\n\r\n  // Loading state\r\n  if (loading) {\r\n    return <VehicleDetailSkeleton />;\r\n  }\r\n\r\n  // Error state\r\n  if (error || !vehicle) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 dark:bg-[#0B0A1B] pb-24 max-w-[430px] mx-auto\">\r\n        <div className=\"px-4 mt-8\">\r\n          <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-2xl p-6\">\r\n            <h2 className=\"text-lg font-semibold text-red-800 dark:text-red-400 mb-2\">\r\n              Error Loading Vehicle\r\n            </h2>\r\n            <p className=\"text-red-600 dark:text-red-400\">{error || \"Vehicle not found\"}</p>\r\n            <button\r\n              onClick={() => router.back()}\r\n              className=\"mt-4 text-red-600 dark:text-red-400 underline\"\r\n            >\r\n              Go back\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const handleFavoriteToggle = async (favorite: boolean) => {\r\n    // Check if user is authenticated\r\n    const token = localStorage.getItem(\"auth_token\");\r\n\r\n    if (!token) {\r\n      // User not authenticated, show auth modal for favorite context\r\n      setAuthContext(\"favorite\");\r\n      setIsAuthModalOpen(true);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (favorite) {\r\n        // Add to favorites\r\n        const { addToFavorites } = await import(\"@/services/client/favorites.service\");\r\n        const response = await addToFavorites(id);\r\n        if (response.success) {\r\n          setIsFavorite(true);\r\n        }\r\n      } else {\r\n        // Remove from favorites\r\n        const { removeFromFavorites } = await import(\"@/services/client/favorites.service\");\r\n        const response = await removeFromFavorites(id);\r\n        if (response.success) {\r\n          setIsFavorite(false);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error toggling favorite:\", error);\r\n      // Revert the UI state on error\r\n      setIsFavorite(!favorite);\r\n    }\r\n  };\r\n\r\n  // const totalRent = vehicle.pricePerHour;\r\n  const ms = dropDate.getTime() - pickupDate.getTime();\r\n  const days = ms / (1000 * 60 * 60 * 24);\r\n\r\n  // Always charge daily rate\r\n  const totalRent = vehicle.pricePerDay * Math.ceil(days);\r\n\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-[#0B0A1B] pb-24 max-w-[430px] mx-auto\">\r\n      {/* Image Slider with integrated controls */}\r\n      <div className=\"px-4 mt-2\">\r\n        <VehicleImageSlider\r\n          images={vehicle.image && vehicle.image.length > 0 ? vehicle.image : [\"/bike.png\"]}\r\n          vehicleName={`${vehicle.brand} ${vehicle.name}`}\r\n          isFavorite={isFavorite}\r\n          onFavoriteToggle={handleFavoriteToggle}\r\n        />\r\n      </div>\r\n\r\n      {/* Vehicle Info Card */}\r\n      <VehicleInfoCard\r\n        brand={vehicle.brand}\r\n        model={vehicle.name}\r\n        pricePerDay={vehicle.pricePerDay}\r\n        freeKilometers={480}\r\n        fuelType={vehicle.fuelType}\r\n      />\r\n\r\n      {/* Pickup & Drop Section */}\r\n      <PickupDropSection\r\n        pickupDate={pickupDate}\r\n        pickupTime={pickupTime}\r\n        pickupLocation={pickupLocation}\r\n        dropDate={dropDate}\r\n        dropTime={dropTime}\r\n        dropLocation={dropLocation}\r\n      />\r\n\r\n      {/* Reviews Section */}\r\n      <ReviewsSection reviews={reviews} />\r\n\r\n      {/* FAQ Section */}\r\n      {faqItems.length > 0 && <FAQAccordion items={faqItems} />}\r\n\r\n      {/* Bottom CTA */}\r\n      <BottomCTA totalRent={totalRent} onBookNow={handleBookNow} />\r\n\r\n      {/* Unified Auth Modal */}\r\n      <AuthModal\r\n        isOpen={isAuthModalOpen}\r\n        onClose={handleAuthModalClose}\r\n        onComplete={handleAuthComplete}\r\n      />\r\n\r\n      {/* License Upload Modal */}\r\n      <LicenseUploadModal\r\n        isOpen={isLicenseModalOpen}\r\n        onClose={handleLicenseModalClose}\r\n        onComplete={handleLicenseComplete}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]}]